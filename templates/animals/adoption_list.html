{% extends 'base.html' %}
{% load static %}

{% block title %}Adoptable Pets - Paws a Moment Rescue{% endblock %}
{% block body_class %}subhero-background{% endblock %}

{% block content %}
<div class="adoption-page-header">
    <h1 class="white-text">Adoptable Pets</h1>
</div>

<section class="purple-curve-section">
    <div class="purple-scenery">
        <svg class="purple-curve" viewBox="0 0 100 60" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg">
            <defs>
                <filter id="curveShadow" x="-20%" y="-20%" width="140%" height="140%">
                    <feDropShadow dx="0" dy="6" stdDeviation="6" flood-color="#000" flood-opacity="0.5"/>
                </filter>
            </defs>
            <path
                d="M0,60 L0,0 Q50,60 100,0 L100,60 Z"
                fill="#f5f5f5"
                filter="url(#curveShadow)"
            />
        </svg>
    </div>
</section>

<div class="adoption-page-wrapper">
    <form method="get" class="tidy-filters">
        <div class="filter-bar">
            <div class="filter-item">
                <input type="text" name="q" value="{{ search_query }}" placeholder="Search name or breed..." class="filter-input">
            </div>

            <div class="filter-item dropdown">
                <button type="button" class="dropbtn">Species <i class="fa fa-caret-down"></i></button>
                <div class="dropdown-content">
                    {% for val, label in species_choices %}
                        <label>
                            <input type="checkbox" name="species" value="{{ val }}" {% if val in species_filter %}checked{% endif %}> {{ label }}
                        </label>
                    {% endfor %}
                </div>
            </div>

            <div class="filter-item dropdown">
                <button type="button" class="dropbtn">Gender <i class="fa fa-caret-down"></i></button>
                <div class="dropdown-content">
                    {% for val, label in sex_choices %}
                        <label>
                            <input type="checkbox" name="sex" value="{{ val }}" {% if val in sex_filter %}checked{% endif %}> {{ label }}
                        </label>
                    {% endfor %}
                </div>
            </div>

            <div class="filter-actions">
                <button type="submit" class="btn-link small-btn">Apply</button>
                <a href="{% url 'animals:adoption_list' %}" class="btn-link lighter-purple small-btn">Clear</a>
            </div>
        </div>
    </form>

    <ul class="card-list">
        {% for animal in animals %}
        <li class="pet-card">
            <div class="card-accent"></div>
            <div class="pet-photo-preview">
                <a href="{% url 'animals:animal_detail' animal.slug %}">
                    {% if animal.primary_image %}
                    <img src="{{ animal.primary_image.url }}" alt="Photo of {{ animal.animal_name }}">
                    {% else %}
                    <img src="{% static 'img/placeholder.png' %}" alt="No photo available for {{ animal.animal_name }}">
                    {% endif %}
                </a>
            </div>
            <div class="card-body">
                <h3 class="card-title">{{ animal.animal_name }}</h3>
                <p class="card-meta">{{ animal.species }} · {{ animal.breed }} </p><p> <strong>{{ animal.sex }}</strong> · {{ animal.location }}</p>
                <p class="card-status">Status: {{ animal.get_status_display }}</p>
                <div class="tag-row">
                    {% if animal.good_with_kids %}<span class="tag">Good with kids</span>{% endif %}
                    {% if animal.special_needs %}<span class="tag tag-special">Special needs</span>{% endif %}
                </div>
                <a class="btn-link" href="{% url 'animals:animal_detail' animal.slug %}">View Profile</a>
            </div>
        </li>
        {% empty %}
        <li class="pet-card">
            <div class="card-body">
                <p>No animals found matching your criteria.</p>
            </div>
        </li>
        {% endfor %}
    </ul>
</div>
{% endblock %}

