{% extends 'base.html' %}
{% load static %}

{% block title %}{{ animal.animal_name }} - Paws a Moment Rescue{% endblock %}
{% block body_class %}subhero-background{% endblock %}

{% block content %}
<style>
    /* 1. Fix the Rogue Shadow at the top */
    .pet-detail-main {
        box-shadow: none !important;
        border: none !important;
        margin-top: 0;
        background: transparent; /* Let the body background show through on the sides */
    }

    /* 2. Fix the "Edge-to-Edge" issue */
    .pet-detail {
        background-color: #f5f5f5; /* The white/light grey box color */
        max-width: 1200px;         /* Match the width of your other pages */
        margin: 0 auto;            /* Center the box */
        padding: 40px;
        border-radius: 15px;       /* Match your card/box curves */
        box-shadow: 0 4px 15px rgba(0,0,0,0.05); /* A soft shadow that doesn't bleed up */
        position: relative;
        top: -30px;                /* Pull the box slightly INTO the purple curve area */
    }
</style>
<div class="adoption-page-header">
    <h1 class="white-text">{{ animal.animal_name }}</h1>
    <p class="pet-hero-meta white-text">{{ animal.species }} · {{ animal.breed }} · {{ animal.location }}</p><br>
    
</div>

<section class="purple-curve-section">
    <div class="purple-scenery">
        <svg class="purple-curve" viewBox="0 0 100 60" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg">
            <defs>
                <filter id="curveShadow" x="-20%" y="-20%" width="140%" height="140%">
                    <feDropShadow dx="0" dy="6" stdDeviation="6" flood-color="#000" flood-opacity="0.5"/>
                </filter>
            </defs>
            <path
                d="M0,60 L0,0 Q50,60 100,0 L100,60 Z"
                fill="#f5f5f5"
                filter="url(#curveShadow)"
            />
        </svg>
    </div>
</section>

<main class="pet-detail-main">
    
    <section class="pet-detail">
        <div class="pet-layout">
            
            <div class="pet-main">
                <div class="pet-photo-main">
                    {% if animal.primary_image %}
                    <img src="{{ animal.primary_image.url }}" alt="Photo of {{ animal.animal_name }}" />
                    {% else %}
                    <img src="{% static 'img/placeholder.png' %}" alt="No photo available" />
                    {% endif %}
                </div>

                {% if gallery_images %}
                <ul class="pet-photo-thumbs">
                    {% for img in gallery_images %}
                    <li><img src="{{ img.image.url }}" alt="Photo of {{ animal.animal_name }} thumbnail {{ forloop.counter }}" /></li>
                    {% endfor %}
                </ul>
                {% endif %}

                <h2>About {{ animal.animal_name }}</h2>
                <p>Status: <strong>{{ animal.get_status_display }}</strong></p>
                <p>{{ animal.description|linebreaks }}</p>
            </div>

            <aside class="pet-vitals">
                <h2>Vitals</h2>
                <ul>
                    {% if animal.dob %}
                    <li><strong>Age:</strong> {% if animal.approximate_dob %}Approx. {% endif %}{{ animal.dob|timesince }}</li>
                    {% endif %}
                    <li><strong>Size:</strong> {{ animal.size }}</li>
                    <li><strong>Sex:</strong> {{ animal.sex }}</li>
                    {% if animal.weight_kg %}
                    <li><strong>Weight:</strong> {{ animal.weight_kg }} kg</li>
                    {% endif %}
                    <li><strong>Adoption fee:</strong> ${{ animal.adoption_fee }}</li>
                    <li><strong>Location:</strong> {{ animal.location }}</li>
                    <li><strong>Status:</strong> {{ animal.get_status_display }}</li>
                    
                </ul>

                <ul class="pet-flags">
                    <li><strong>Good with kids:</strong> {% if animal.good_with_kids %}Yes{% else %}No{% endif %}</li>
                    <li><strong>Special needs:</strong> {% if animal.special_needs %}Yes{% else %}No{% endif %}</li>
                    <!--<li><strong>Microchipped:</strong> {% if animal.microchipped %}Yes{% else %}No{% endif %}</li>-->
                    <li><strong>Vaccinated:</strong> {% if animal.vaccinated %}Yes{% else %}No{% endif %}</li>
                    <li><strong>Desexed:</strong> {% if animal.desexed %}Yes{% else %}No{% endif %}</li>
                    <li><strong>Microchipped:</strong> 
                        {% if animal.microchipped %}
                        Yes {% if animal.microchip_number %}(#{{ animal.microchip_number }}){% endif %}
                        {% else %}
                        No
                        {% endif %}
                    </li>
                </ul>

                <a class="btn-link" href="{% url 'applications:adoption_landing_page' %}?pet={{ animal.slug }}">Apply to adopt {{ animal.animal_name }}</a>
            </aside>
        </div>
    </section>
</main>

{% endblock %}
{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const mainImage = document.querySelector('.pet-photo-main img');
        const thumbnails = document.querySelectorAll('.pet-photo-thumbs img');

        thumbnails.forEach(thumb => {
            thumb.style.cursor = 'pointer'; // Make it clear they are clickable
            thumb.addEventListener('click', function() {
                // Change the main image src to the thumbnail src
                mainImage.src = this.src;
                
                // Visual feedback: Highlight active thumb
                thumbnails.forEach(t => t.style.border = 'none');
                this.style.border = '2px solid #602263';
            });
        });
    });
</script>
{% endblock %}
